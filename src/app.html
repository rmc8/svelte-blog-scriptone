<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/logo/scriptone_logo_icon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@rmc_km" />
		<meta name="twitter:creator" content="@rmc_km" />
		<meta property="og:title" content="Scriptone" />
		<meta property="og:site_name" content="Scriptone" />
		<meta property="og:image" content="https://rmc-8.com/logo/scriptone_card.png" />
		<link rel="preconnect" href="https://www.googletagmanager.com">
		<link rel="preconnect" href="https://pagead2.googlesyndication.com">
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
		<script type="module">
			// 広告とGoogle Tag Managerの遅延読み込み
			const loadScripts = async () => {
				const loadScript = (src, attrs = {}) => {
					return new Promise((resolve, reject) => {
						const script = document.createElement('script');
						script.src = src;
						Object.entries(attrs).forEach(([key, value]) => script.setAttribute(key, value));
						script.onload = resolve;
						script.onerror = reject;
						document.body.appendChild(script);
					});
				};

				try {
					// AdSenseスクリプトの読み込み
					await loadScript("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5016891070616278", {
						async: true,
						crossOrigin: "anonymous"
					});

					// Google Tag Managerスクリプトの読み込み
					await loadScript("https://www.googletagmanager.com/gtag/js?id=G-TMCBTNX7PX", { async: true });

					// 広告設定
					window.adsbygoogle = window.adsbygoogle || [];
					window.adsbygoogle.pauseAdRequests = 1;
					window.adsbygoogle.requestNonPersonalizedAds = 1;

					// メインコンテンツ読み込み後に広告リクエストを再開
					setTimeout(() => {
						window.adsbygoogle.pauseAdRequests = 0;
					}, 1000);

					// Google Analytics設定
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-TMCBTNX7PX');
				} catch (error) {
					console.error('Script loading error:', error);
				}
			};

			// ページコンテンツ読み込み後にスクリプトを読み込む
			window.addEventListener('load', loadScripts);
		</script>
	</body>
</html>